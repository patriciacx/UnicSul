"0","# within sum of squares"
"0","wss <- function(d) {"
"0","  sum(scale(d, scale = FALSE)^2)"
"0","}"
"0","# wrap the data"
"0","wrap <- function(i, hc, x) {"
"0","  cl <- cutree(hc, i)"
"0","  spl <- split(x, cl)"
"0","  wss <- sum(sapply(spl, wss))"
"0","  wss"
"0","}"
"0","elbow_plot<- function(data, dissim,met){"
"0","  cl = hclust(dissim, method = met)  "
"0","  res <- sapply(seq.int(1, nrow(data)), "
"0","                wrap, h =cl, "
"0","                x = data)"
"0","  return(res)"
"0","}"
